<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sidebar - Cabinet Notaire</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
        }

        .sidebar {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 256px;
            background-color: #0f172a;
            color: white;
            position: fixed;
            left: 0;
            top: 0;
            overflow-y: auto;
        }

        .sidebar-header {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 64px;
            border-bottom: 1px solid #1e293b;
            padding: 0 16px;
        }

        .sidebar-header h1 {
            font-size: 18px;
            font-weight: 700;
            text-align: center;
        }

        .sidebar-nav {
            flex: 1;
            padding: 16px 8px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 8px 16px;
            margin-bottom: 4px;
            color: #cbd5e1;
            text-decoration: none;
            border-radius: 6px;
            transition: all 0.2s;
            font-size: 14px;
            font-weight: 500;
        }

        .nav-item:hover {
            background-color: #1e293b;
            color: white;
        }

        .nav-item.active {
            background-color: #1e293b;
            color: white;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .nav-section {
            margin-top: 24px;
            padding-top: 16px;
            border-top: 1px solid #1e293b;
        }

        .nav-section-title {
            padding: 0 16px 8px;
            font-size: 12px;
            font-weight: 600;
            color: #64748b;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Icons SVG */
        .icon-dashboard { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-users { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-folder { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-file { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-calendar { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-calculator { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-settings { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-archive { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-wallet { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-refresh { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-chart { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-scale { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-code { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-shield { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-mail { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-user-circle { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }
        .icon-home { fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

        /* Scrollbar */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: #0f172a;
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: #334155;
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: #475569;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="sidebar-header">
            <h1 id="office-name">Cabinet Notaire Keur Jaraaf</h1>
        </div>

        <nav class="sidebar-nav">
            <!-- Navigation principale -->
            <a href="/dashboard" class="nav-item" data-page="dashboard">
                <svg class="nav-icon icon-dashboard" viewBox="0 0 24 24">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                Tableau de bord
            </a>

            <a href="/dashboard/clients" class="nav-item" data-page="clients">
                <svg class="nav-icon icon-users" viewBox="0 0 24 24">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                Clients
            </a>

            <a href="/dashboard/dossiers" class="nav-item" data-page="dossiers">
                <svg class="nav-icon icon-folder" viewBox="0 0 24 24">
                    <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
                </svg>
                Dossiers
            </a>

            <a href="/dashboard/actes" class="nav-item" data-page="actes">
                <svg class="nav-icon icon-file" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                    <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                Actes
            </a>

            <a href="/dashboard/templates" class="nav-item" data-page="templates">
                <svg class="nav-icon icon-code" viewBox="0 0 24 24">
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
                Templates
            </a>

            <a href="/dashboard/archives" class="nav-item" data-page="archives">
                <svg class="nav-icon icon-archive" viewBox="0 0 24 24">
                    <polyline points="21 8 21 21 3 21 3 8"></polyline>
                    <rect x="1" y="3" width="22" height="5"></rect>
                    <line x1="10" y1="12" x2="14" y2="12"></line>
                </svg>
                Archives
            </a>

            <a href="/dashboard/comptabilite" class="nav-item" data-page="comptabilite">
                <svg class="nav-icon icon-calculator" viewBox="0 0 24 24">
                    <rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect>
                    <line x1="8" y1="6" x2="16" y2="6"></line>
                    <line x1="8" y1="10" x2="16" y2="10"></line>
                    <line x1="8" y1="14" x2="16" y2="14"></line>
                    <line x1="8" y1="18" x2="12" y2="18"></line>
                </svg>
                Comptabilité
            </a>

            <a href="/dashboard/tresorerie/caisse" class="nav-item" data-page="tresorerie">
                <svg class="nav-icon icon-wallet" viewBox="0 0 24 24">
                    <path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"></path>
                    <path d="M3 5v14a2 2 0 0 0 2 2h16v-5"></path>
                    <path d="M18 12a2 2 0 0 0 0 4h4v-4Z"></path>
                </svg>
                Trésorerie
            </a>

            <a href="/dashboard/facturation" class="nav-item" data-page="facturation">
                <svg class="nav-icon icon-file" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="16" y1="13" x2="8" y2="13"></line>
                    <line x1="16" y1="17" x2="8" y2="17"></line>
                </svg>
                Facturation
            </a>

            <a href="/dashboard/rapprochement" class="nav-item" data-page="rapprochement">
                <svg class="nav-icon icon-refresh" viewBox="0 0 24 24">
                    <polyline points="23 4 23 10 17 10"></polyline>
                    <polyline points="1 20 1 14 7 14"></polyline>
                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                </svg>
                Rapprochement
            </a>

            <a href="/dashboard/rapports" class="nav-item" data-page="rapports">
                <svg class="nav-icon icon-chart" viewBox="0 0 24 24">
                    <line x1="18" y1="20" x2="18" y2="10"></line>
                    <line x1="12" y1="20" x2="12" y2="4"></line>
                    <line x1="6" y1="20" x2="6" y2="14"></line>
                </svg>
                Rapports
            </a>

            <a href="/dashboard/recherche-juridique" class="nav-item" data-page="recherche-juridique">
                <svg class="nav-icon icon-scale" viewBox="0 0 24 24">
                    <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"></path>
                    <path d="M5 3v4"></path>
                    <path d="M19 17v4"></path>
                    <path d="M3 5h4"></path>
                    <path d="M17 19h4"></path>
                </svg>
                Recherche Juridique
            </a>

            <a href="/dashboard/agenda" class="nav-item" data-page="agenda">
                <svg class="nav-icon icon-calendar" viewBox="0 0 24 24">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                Agenda
            </a>

            <a href="/dashboard/formalites" class="nav-item" data-page="formalites">
                <svg class="nav-icon icon-file" viewBox="0 0 24 24">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                </svg>
                Formalités
            </a>

            <a href="/dashboard/crm" class="nav-item" data-page="crm">
                <svg class="nav-icon icon-mail" viewBox="0 0 24 24">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                    <polyline points="22,6 12,13 2,6"></polyline>
                </svg>
                CRM
            </a>

            <a href="/dashboard/portail-client" class="nav-item" data-page="portail-client">
                <svg class="nav-icon icon-user-circle" viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="10"></circle>
                    <circle cx="12" cy="10" r="3"></circle>
                    <path d="M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662"></path>
                </svg>
                Portail Client
            </a>

            <a href="/dashboard/negociation" class="nav-item" data-page="negociation">
                <svg class="nav-icon icon-home" viewBox="0 0 24 24">
                    <path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                Négociation
            </a>

            <!-- Section Admin -->
            <div class="nav-section" id="admin-section" style="display: none;">
                <div class="nav-section-title">Administration</div>
                
                <a href="/dashboard/admin/users" class="nav-item" data-page="admin-users">
                    <svg class="nav-icon icon-users" viewBox="0 0 24 24">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                        <circle cx="9" cy="7" r="4"></circle>
                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                    </svg>
                    Utilisateurs
                </a>

                <a href="/dashboard/admin/privileges" class="nav-item" data-page="admin-privileges">
                    <svg class="nav-icon icon-shield" viewBox="0 0 24 24">
                        <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                    </svg>
                    Privilèges
                </a>

                <a href="/dashboard/parametres" class="nav-item" data-page="parametres">
                    <svg class="nav-icon icon-settings" viewBox="0 0 24 24">
                        <circle cx="12" cy="12" r="3"></circle>
                        <path d="M12 1v6m0 6v6m5.196-15.196l-4.242 4.242m0 5.908l-4.242 4.242M23 12h-6m-6 0H1m15.196 5.196l-4.242-4.242m0-5.908l-4.242-4.242"></path>
                    </svg>
                    Paramètres
                </a>
            </div>
        </nav>
    </div>

    <script>
        // Récupérer le nom de l'office
        fetch('/api/office-name')
            .then(res => res.json())
            .then(data => {
                document.getElementById('office-name').textContent = data.officeName || 'Cabinet Notaire';
            })
            .catch(() => {
                document.getElementById('office-name').textContent = 'Cabinet Notaire Keur Jaraaf';
            });

        // Vérifier si l'utilisateur est admin
        fetch('/api/auth/session')
            .then(res => res.json())
            .then(session => {
                if (session?.user?.role === 'ADMIN') {
                    document.getElementById('admin-section').style.display = 'block';
                }
            })
            .catch(() => {
                // Pas de session, masquer admin
            });

        // Marquer l'élément actif basé sur l'URL
        const currentPath = window.location.pathname;
        const navItems = document.querySelectorAll('.nav-item');
        
        navItems.forEach(item => {
            const href = item.getAttribute('href');
            if (currentPath === href || currentPath.startsWith(href + '/')) {
                item.classList.add('active');
            }
        });

        // Ajouter un effet de clic
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                // Retirer active de tous
                navItems.forEach(i => i.classList.remove('active'));
                // Ajouter active à celui cliqué
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>
